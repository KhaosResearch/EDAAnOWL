@prefix : <https://w3id.org/EDAAnOWL/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix dcat: <http://www.w3.org/ns/dcat#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .

#################################################################
#    DCAT-AP Alignment Shapes
#    These shapes ensure that EDAAnOWL assets are compatible 
#    with the European DCAT Application Profile.
#################################################################

:DCATAlignmentShape a sh:NodeShape ;
    sh:targetClass :DataAsset ;
    rdfs:label "DCAT-AP Alignment Shape"@en ;
    rdfs:comment "Ensures EDAAnOWL Assets are discoverable via DCAT portals."@en ;
    
    # Dual Typing Recommendation
    sh:property [
        sh:path [ sh:inversePath <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ] ;
        sh:minCount 1 ;
        sh:message "To be visible in European Data Portals, a :DataAsset should also be typed as dcat:Dataset."@en ;
        sh:severity sh:Warning ;
    ] ;

    # Conformance Declaration
    sh:property [
        sh:path dct:conformsTo ;
        sh:minCount 1 ;
        sh:nodeKind sh:IRI ;
        sh:severity sh:Info ;
        sh:message "It is recommended to declare conformance to DCAT-AP or specific regulations (e.g. HVD) using dct:conformsTo."@en ;
    ] ;

    # Use of Controlled Vocabularies (AGROVOC/EuroSciVoc)
    sh:property [
        sh:path dcat:theme ;
        sh:minCount 1 ;
        sh:class skos:Concept ;
        sh:pattern "^http://aims.fao.org/aos/agrovoc/" ;
        sh:message "It is highly recommended to use direct AGROVOC URIs for dcat:theme to ensure EU-wide interoperability."@en ;
        sh:severity sh:Warning ;
    ] ;
    
    # Direct Reuse for Sector
    sh:property [
        sh:path :hasDomainSector ;
        sh:minCount 0 ;
        sh:pattern "^http://aims.fao.org/aos/agrovoc/" ;
        sh:message "Use direct AGROVOC URIs for :hasDomainSector to avoid local proxy silos."@en ;
        sh:severity sh:Warning ;
    ] .
